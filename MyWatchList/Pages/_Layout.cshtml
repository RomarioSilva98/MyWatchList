@using MyWatchList.Models
@inject IHttpContextAccessor HttpContextAccessor

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="utf-8" />
    <title>@ViewData["Title"] - MyWatchList</title>
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="page-container navbar-content">
                <div class="nav-left">
                    <a asp-page="/Index" class="brand">🎬 MyWatchList</a>
                    <form method="get" asp-page="/Index" class="search-form">
                        <input type="text" name="query" placeholder="Buscar obras..." />
                        <button type="submit">🔍</button>
                    </form>
                </div>
            @{
                var usuarioId = HttpContextAccessor.HttpContext.Session.GetInt32("UsuarioId");
                var tipo = HttpContextAccessor.HttpContext.Session.GetString("UsuarioTipo");
            }

            <div class="nav-right">
                @if (usuarioId != null)
                {
                    <div class="dropdown">
                        <button class="menu-button">☰</button>
                        <div class="dropdown-content">
                            <a asp-page="/Usuarios/Edit" asp-route-id="@usuarioId">👤 Perfil</a>
                            <a asp-page="/Usuarios/MyWatchlist">📺 Watchlist</a>

                            <hr />
                            @if (tipo == "Admin")
                            {
                                <a asp-page="/Obras/Create">🎥 Criar Obra</a>
                            }

                            <a asp-page="/ListasPersonalizadas/Create">➕ Criar Lista</a>
                            <a asp-page="/ListasPersonalizadas/Index">📚 Minhas Listas</a>

                            <hr />
                            <a asp-page="/Usuarios/Logout">🚪 Sair</a>
                        </div>
                    </div>
                }
                else
                {
                    <a asp-page="/Usuarios/Login" class="btn-login">🔐 Entrar</a>
                }
            </div>
        </nav>
    </header>


    <main role="main" class="container">
        @RenderBody()
    </main>

    <footer>
        <p>&copy; 2025 - MyWatchList</p>
    </footer>

    @RenderSection("Scripts", required: false)
</body>
</html>
